name: Auto PR to Main on Merge to Dev

on:
    pull_request:
        branches:
            - dev
        types: [closed]

jobs:
    create-pull-request:
        runs-on: ubuntu-latest
        if: github.event.pull_request.merged == true
        steps:
            - name: Check out code
              uses: actions/checkout@v3
              with:
                  ref: "dev"

            - name: Setup Git
              run: |
                  git config user.name "GitHub Actions"
                  git config user.email "actions@github.com"

            - name: Create Pull Request to Main
              uses: peter-evans/create-pull-request@v4
              with:
                  branch: "auto-pr-to-main-${{ github.run_id }}"
                  commit-message: "Merge dev into main"
                  title: "Merge dev into main"
                  body: "This is an automated pull request to merge changes from dev into main."
                  base: "main"
                  delete-branch: true
